---
title: "Evaluation of the loss of commercial length samples for Pacific Cod (*Gadus macrocephalus*) for Area 3CD and Area 5ABCD in 2022. *Do not circulate without permission from the authors*."
author: "Robyn Forrest, ..."
date: "07/06/2022"
link-citations: true
bibliography: bib/refs.bib
documentclass: article
geometry: margin=2.2cm
output:
  bookdown::pdf_document2:
    toc: yes
    fig_caption: yes
    number_sections: yes
---

```{r setup, echo=FALSE, cache=FALSE, message=FALSE, results='hide', warning=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  comment = "#>",
  fig.path = "knitr-figs/",
  cache.path = if (knitr:::is_latex_output()) "knitr-cache-tex/" else "knitr-cache-docx/",
  fig.asp = 0.618,
  fig.width = 6.5,
  out.width = "5in",
  echo = FALSE,
  autodep = TRUE,
  cache = TRUE,
  cache.comments = FALSE,
  dev = if (knitr:::is_latex_output()) "pdf" else "png",
  dpi = 200,
  fig.align = "center",
  fig.pos = "htb"
)
french <- FALSE
source(file.path(here::here(), "R", "all.R")) #Loading the data is in this file (or pulling it from GFBio if it doesn't exist yet)

```

```{r custom-vars, cache=TRUE, echo=FALSE, message=FALSE, results='hide'}
#NOTE. if adding sensitivity models need to modify load.models.into.parent.env()
# in model-setup.R (as well as path names to sensitivity folders)
build(ovwrt.base = FALSE,
      ovwrt.sens = FALSE,
      ovwrt.retro = FALSE,
      burnin = 1000,
      thin = 1)

load.models.into.parent.env()

source(file.path(rootd.R, "custom-knitr-variables.R")) # Making catch data objects is in this file
```

```{r setup-tables, cache=FALSE, echo=FALSE}
if(!knitr:::is_latex_output())
  options(knitr.table.format = "pandoc")
```


# Context

The last assessment for Pacific cod (*Gadus macrocephalus*) in British Columbia (BC) was completed in 2020 [@dfo2021].
Separate assessments were done for stocks in Area 3CD (West Coast Vancouver Island, WCVI) and Area 5ABCD (Queen Charlotte Sound (QCS) and Hecate Strait (HS) combined). GMU have requested science advice to update to the stock assessment for both areas by November 2022 (advice for fishing opportunities in 2023).

The stock assessment is a delay-difference model, fit to commercial and survey indices of abundance, commercial catch and an an index of commercial mean weight, derived from commercial length samples [@forrest2020]. Due to the COVID-19 pandemic and a subsequent shift towards at-sea electronic monitoring, there has been no at-sea biological sampling on commercial trawl vessels since 2019. The 2020 assessment update used the 2019 mean weight value for 2020 for both stocks. For the 2022 assessment update, it will have been three years since the time series of commercial mean weights was updated (i.e., no new data since 2019). In general, even before the pandemic, there was a decline in commercial sampling of Pacific cod (Appendix A). 

Here, we report on the potential impact of the loss of commercial sampling in 2020-2022, by comparing results from the 2020 stock assessment [@dfo2021] with three alternative data treatments that attempt to mitigate a hypothetical loss of commercial biological sampling from 2018 to 2020. This represents a loss of the most recent three years of data from the 2020 stock assessment, to mimic the effect of losing three years of data (2020 to 2022) in the upcoming 2022 assessment.

We caution that the true impact of missing commercial length data from 2020 to 2022 can never be fully evaluated, as these data will never exist. However, the results of this analysis can provide guidance on the likely relative impact of using each of the four approaches on stock assessment results.

# Methods

## Short-term loss of commercial length data 


For each area (3CD and 5ABCD), we evaluated three alternative treatments of the commercial mean weight index, by comparing 2020 results to the 2020 Reference case [@dfo2021]. For each scenario, we compared estimates of biomass, recruitment and key model parameters to those from the 2020 assessment. Apart for the treatment of the final three years of the commercial mean weight index, all other model settings are identical to the reference cases.

The three treatments (scenarios) were:

**NOTE ABOUT 3CD BASE: the 2017 value was anomalously high (3.024 kg) and was not used in the 2020 assessment. There was no 2018 value. So here for Scenario 1, we will delete data for 2019-2020. For Scenario 2 we will use the 2016 value for the years 2018:2020 (maintaining the missing data in 2017 but adding a data point in 2018). For Scenario 3, we will use the average 2014-2016 for 2018-2020 (again,adding a data point in 2018) **

Sc 1. For 3CD, include no commercial mean weight index for the last four years of the assessment (the 2020 assessment had no data for 2017 and 2018). For 5ABCD, include no commercial mean weight index for the last four years of the assessment.

Sc 2. For 3CD, use the 2016 commercial mean weight index value for model years 2018, 2019 and 2020. For 5ABCD, use the 2017 commercial mean weight index value for model years 2018, 2019 and 2020. 

Sc 3. For 3CD, use the 2014-2016 average of the commercial mean weight index for model years 2018, 2019 and 2020. For 5ABCD, use the 2015-2017 average of the commercial mean weight index for model years 2018, 2019 and 2020.
   
Resulting mean weight indices are shown in Figs XX.

## Medium-term loss of commercial length data

ADD TEXT HERE

# Results

*TODO: update text for sensitivity analyses, add biomass, recruitment and depletion tables, add depletion and recruitment plots, calculate percentage differences*

## Area 3CD

Reference point estimates from the Reference case model are shown in Table \@ref(tab:tab-param-est-table-3cd).

Reference point estimates from Sc 1-4 are shown in Tables \@ref(tab:tab-param-est-table-3cd-sc1) to \@ref(tab:tab-param-est-table-3cd-sc2).

Fits to the commercial mean weight index from the Reference case model are shown in Figure \@ref(fig:fig-base-mean-weight-3cd).

Biomass estimates from the Reference case model are shown in Figure \@ref(fig:fig-model-ref-biomass-3cd).

## Area 5ABCD

Reference point estimates from the Reference case model are shown in Table \@ref(tab:tab-param-est-table-5abcd).

Reference point estimates from Sc 1-4 are shown in Tables \@ref(tab:tab-param-est-table-5abcd-sc1) to \@ref(tab:tab-param-est-table-5abcd-sc2).

Fits to the commercial mean weight index from the Reference case model are shown in Figure \@ref(fig:fig-base-mean-weight-5abcd).

Biomass estimates from the Reference case model are shown in Figure \@ref(fig:fig-model-ref-biomass-5abcd).



# References {-}

<div id="refs"></div>

\clearpage

# Tables {#sec:tables}

## Area 3CD

```{r tab-mean-weight-recent-3cd, results='asis'}
mw.table(c(base.model.3cd, sens.models.11), 
         c(base.model.3cd.name, sens.models.name.11), 
         years=2010:2020,
         caption="Comparison of mean weight values used in the 2020 Reference case model and sensitivity analyses, Area 3CD. Sc 1 = no mean weight index for 2018:2020; Sc 2 = 2016 mean weight value for 2018:2020; Sc 3 = mean(2014:2016) mean weight value for 2018:2020.")

```


```{r tab-param-est-biomass-3cd, results='asis'}
make.value.table.compare(c(base.model.3cd, sens.models.11), 
                 c(base.model.3cd.name, sens.models.name.11), 
                 years=2010:2021,
                 type= 1,
                 mpdmed="med",
                 caption = "Comparison of recent median posterior biomass estimates from the 2020 Reference case model and sensitivity analyses, Area 3CD. Sc 1 = no mean weight index for 2018:2020; Sc 2 = 2016 mean weight value for 2018:2020; Sc 3 = mean(2014:2016) mean weight value for 2018:2020.")

```

\clearpage


```{r tab-param-est-biomass-3cd-per, results='asis'}
make.value.table.compare(c(base.model.3cd, sens.models.11), 
                 c(base.model.3cd.name, sens.models.name.11), 
                 years=2010:2021,
                 type= 1,
                 mpdmed="med",
                 caption = "Comparison of percentage difference in median posterior biomass estimates from the 2020 Reference case model and sensitivity analyses, Area 3CD. Sc 1 = no mean weight index for 2018:2020; Sc 2 = 2016 mean weight value for 2018:2020; Sc 3 = mean(2014:2016) mean weight value for 2018:2020.",
                 percent=TRUE)

```


```{r tab-param-est-recruit-3cd, results='asis'}
make.value.table.compare(c(base.model.3cd, sens.models.11), 
                 c(base.model.3cd.name, sens.models.name.11), 
                 years=2010:2020,
                 type= 2,
                 mpdmed="med",
                 caption = "Comparison of percentage difference in median posterior recruitment estimates from the 2020 Reference case model and sensitivity analyses, Area 3CD. Sc 1 = no mean weight index for 2018:2020; Sc 2 = 2016 mean weight value for 2018:2020; Sc 3 = mean(2014:2016) mean weight value for 2018:2020.",
                 percent=TRUE)

```

\clearpage

## Area 5ABCD

```{r tab-mean-weight-recent-5abcd, results='asis'}
mw.table(c(base.model.5abcd, sens.models.1), 
         c(base.model.5abcd.name, sens.models.name.1), 
         years=2010:2020,
         caption="Comparison of mean weight values used in the 2020 Reference case model and sensitivity analyses, Area 5ABCD. Sc 1 = no mean weight index for 2018:2020; Sc 2 = 2017 mean weight value for 2018:2020; Sc 3 = mean(2015:2017) mean weight value for 2018:2020.")

```


```{r tab-param-est-biomass-5abcd, results='asis'}
make.value.table.compare(c(base.model.5abcd, sens.models.1), 
                 c(base.model.5abcd.name, sens.models.name.1), 
                 years=2010:2021,
                 type= 1,
                 mpdmed="med",
                 caption = "Comparison of recent median posterior biomass estimates from the 2020 Reference case model and sensitivity analyses, Area 5ABCD. Sc 1 = no mean weight index for 2018:2020; Sc 2 = 2017 mean weight value for 2018:2020; Sc 3 = mean(2015:2017) mean weight value for 2018:2020.")

```

\clearpage


```{r tab-param-est-biomass-5abcd-per, results='asis'}
make.value.table.compare(c(base.model.5abcd, sens.models.1), 
                 c(base.model.5abcd.name, sens.models.name.1), 
                 years=2010:2021,
                 type= 1,
                 mpdmed="med",
                 caption = "Comparison of percentage difference in median posterior biomass estimates from the 2020 Reference case model and sensitivity analyses, Area 5ABCD. Sc 1 = no mean weight index for 2018:2020; Sc 2 = 2017 mean weight value for 2018:2020; Sc 3 = mean(2015:2017) mean weight value for 2018:2020.",
                 percent=TRUE)

```


```{r tab-param-est-recruit-5abcd, results='asis'}
make.value.table.compare(c(base.model.5abcd, sens.models.1), 
                 c(base.model.5abcd.name, sens.models.name.1), 
                 years=2010:2020,
                 type= 2,
                 mpdmed="med",
                 caption = "Comparison of percentage difference in median posterior recruitment estimates from the 2020 Reference case model and sensitivity analyses, Area 5ABCD. Sc 1 = no mean weight index for 2018:2020; Sc 2 = 2017 mean weight value for 2018:2020; Sc 3 = mean(2015:2017) mean weight value for 2018:2020.",
                 percent=TRUE)

```



\clearpage

# Figures {#sec:figures}

## Area 3CD

```{r fig-base-mean-weight-3cd, fig.cap="Reference model MPD fit to the mean weight data for Area 3CD. For clarity, only MPD results are shown."}
plot_grid(mw.plot(base.model.3cd[[1]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(base.model.3cd[[1]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-base-mean-weight-3cd-sc1, fig.cap="Scenario 1 model MPD fit to the mean weight data for Area 3CD (no data for 2018-2020). For clarity, only MPD results are shown."}
plot_grid(mw.plot(sens.models.11[[1]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(sens.models.11[[1]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-base-mean-weight-3cd-sc2, fig.cap="Scenario 2 model MPD fit to the mean weight data for Area 3CD (2016 mean weight index value used for 2018-2020). For clarity, only MPD results are shown."}
plot_grid(mw.plot(sens.models.11[[2]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(sens.models.11[[2]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-base-mean-weight-3cd-sc3, fig.cap="Scenario 2 model MPD fit to the mean weight data for Area 3CD (mean 2014:2016 index value used for 2018-2020). For clarity, only MPD results are shown."}
plot_grid(mw.plot(sens.models.11[[3]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(sens.models.11[[3]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-model-ref-biomass-3cd, fig.cap="Combined posterior biomass for the reference case model for Area 3CD. Thick solid line shows the posterior median and the grey shaded region represents the 95\\% credible interval. Green dashed line shows the median USR; red dashed line shows the median LRP. Red and green shaded intervals represent the 95\\% credible interval of the LRP and USR, respectively."}
b.plot(base.model.3cd,
       base.model.3cd.name,
       depl = FALSE,
       add.hist.ref = TRUE,
       lrp = c(1986, 1986),
       usr = c(1956, 2004), french=french)
```

```{r fig-sens-biomass-3cd, fig.cap="Sensitivity of biomass estimates to the three treatments of the commercial mean weight index, Area 3CD."}
b.plot(c(base.model.3cd, sens.models.11), c(base.model.3cd.name, sens.models.name.11))
```

```{r fig-sens-recr-3cd, fig.cap="Sensitivity of recruitment estimates to the three treatments of the commercial mean weight index, Area 3CD."}
r.plot(c(base.model.3cd, sens.models.11), c(base.model.3cd.name, sens.models.name.11))
```

\clearpage

## Area 5ABCD

```{r fig-base-mean-weight-5abcd, fig.cap="Reference model MPD fit to the mean weight data for Area 5ABCD. For clarity, only MPD results are shown"}
plot_grid(mw.plot(base.model.5abcd[[1]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(base.model.5abcd[[1]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-base-mean-weight-5abcd-sc1, fig.cap="Scenario 1 model MPD fit to the mean weight data for Area 5ABCD (no data for 2018-2020). For clarity, only MPD results are shown."}
plot_grid(mw.plot(sens.models.1[[1]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(sens.models.1[[1]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-base-mean-weight-5abcd-sc2, fig.cap="Scenario 2 model MPD fit to the mean weight data for Area 5ABCD (2017 mean weight index value used for 2018-2020). For clarity, only MPD results are shown."}
plot_grid(mw.plot(sens.models.1[[2]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(sens.models.1[[2]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-base-mean-weight-5abcd-sc3, fig.cap="Scenario 3 model MPD fit to the mean weight data for Area 5ABCD (mean 2015:2017 index value used for 2018-2020). For clarity, only MPD results are shown."}
plot_grid(mw.plot(sens.models.1[[3]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(sens.models.1[[3]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-model-ref-biomass-5abcd, fig.cap="Combined posterior biomass for the reference case model for Area 5ABCD. Thick solid line shows the posterior median and the grey shaded region represents the 95\\% credible interval. Green dashed line shows the median USR; red dashed line shows the median LRP. Red and green shaded intervals represent the 95\\% credible interval of the LRP and USR, respectively."}
b.plot(base.model.5abcd,
       base.model.5abcd.name,
       depl = FALSE,
       add.hist.ref = TRUE,
       lrp = c(2000, 2000),
       usr = c(1956, 2004), french=french)
```

```{r fig-sens-biomass-5abcd, fig.cap="Sensitivity of biomass estimates to the three treatments of the commercial mean weight index, Area 5ABCD."}
b.plot(c(base.model.5abcd, sens.models.1), c(base.model.5abcd.name, sens.models.name.1))
```

```{r fig-sens-recr-5abcd, fig.cap="Sensitivity of recruitment estimates to the three treatments of the commercial mean weight index, Area 5ABCD."}
r.plot(c(base.model.5abcd, sens.models.1), c(base.model.5abcd.name, sens.models.name.1))
```


\clearpage

# (APPENDIX) Appendix {-} 

# Changes in commercial length sampling {#sec:AppendixA}

## Area 3CD

```{r get-length-samples-3cd}

comm_samp <- dat$commercial_samples %>% 
  dplyr::filter(major_stat_area_name %in% c("3C: S.W. VANCOUVER ISLAND","3D: N.W. VANCOUVER ISLAND"), 
                year>1995) 

summary_by_year <- comm_samp %>% 
  select(year,sample_id,length) %>% 
  group_by(year) %>%
  summarize(nsamples=n_distinct(sample_id),
            nlengths=sum(!is.na(length)),
            meanlength=round(mean(length),2),
            sdlength=round(sd(length),2),
            selength=round(sdlength/sqrt(nlengths),2))

 colnames(summary_by_year) <- c("Year", "Num samples", "Num lengths","Raw mean length", "SD length", "SE length")

knitr::kable(summary_by_year,
               caption = "Summary of commercial length samples since 1996 for Area 3CD. Mean lengths are unweighted by catch and are presented simply to visualise changes in sampling effort since 2015.",
               longtable = TRUE, format = "pandoc",
               align = get.align(ncol(summary_by_year))[-1],
               booktabs = TRUE, linesep = "", escape = FALSE, row.names = FALSE) %>%
    kableExtra::kable_styling(latex_options = c("hold_position", "repeat_header"))

```

```{r plot-length-samples-3cd, fig.cap="Summary of commercial length samples since 2012 for Area 3CD. Mean lengths are unweighted by catch and are presented simply to visualise changes in sampling effort since 2012."}

g <- summary_by_year %>% 
  dplyr::filter(Year>2011) %>% 
  ggplot(aes(x=Year, y=`Raw mean length`))+
  geom_point(size=3)+
  geom_errorbar(aes(ymin=`Raw mean length`-`SE length`, ymax=`Raw mean length`+ `SE length`),  width=0.1)+
  labs(x = "Year", y = "Raw mean weight (cm)")+
  gfplot::theme_pbs()+
  scale_color_viridis_d() +
  theme(plot.title = element_text(face="bold", size=14),
        axis.title.x = element_text(size=12),
        axis.title.y = element_text(size=12),
        axis.text.y = element_text(size=12),
        axis.text.x = element_text(size=10))

g

```

\clearpage

## Area 5ABCD

```{r get-length-samples-5abcd}

comm_samp <- dat$commercial_samples %>% 
  dplyr::filter(major_stat_area_name %in% c("5A: SOUTHERN Q.C. SOUND" ,"5B: NORTHERN Q.C. SOUND","5C: SOUTHERN HECATE STRAIT","5D: NORTHERN HECATE STRAIT"), 
                year>1995) 

summary_by_year <- comm_samp %>% 
  select(year,sample_id,length) %>% 
  group_by(year) %>%
  summarize(nsamples=n_distinct(sample_id),
            nlengths=sum(!is.na(length)),
            meanlength=round(mean(length),2),
            sdlength=round(sd(length),2),
            selength=round(sdlength/sqrt(nlengths),2))

 colnames(summary_by_year) <- c("Year", "Num samples", "Num lengths","Raw mean length", "SD length", "SE length")

knitr::kable(summary_by_year,
               caption = "Summary of commercial length samples since 1996 for Area 5ABCD. Mean lengths are unweighted by catch and are presented simply to visualise changes in sampling effort since 2015.",
               longtable = TRUE, format = "pandoc",
               align = get.align(ncol(summary_by_year))[-1],
               booktabs = TRUE, linesep = "", escape = FALSE, row.names = FALSE) %>%
    kableExtra::kable_styling(latex_options = c("hold_position", "repeat_header"))

```

```{r plot-length-samples-5abcd, fig.cap="Summary of commercial length samples since 2012 for Area 5ABCD. Mean lengths are unweighted by catch and are presented simply to visualise changes in sampling effort since 2012."}

g <- summary_by_year %>% 
  dplyr::filter(Year>2011) %>% 
  ggplot(aes(x=Year, y=`Raw mean length`))+
  geom_point(size=3)+
  geom_errorbar(aes(ymin=`Raw mean length`-`SE length`, ymax=`Raw mean length`+ `SE length`),  width=0.1)+
  labs(x = "Year", y = "Raw mean weight (cm)")+
  gfplot::theme_pbs()+
  scale_color_viridis_d() +
  theme(plot.title = element_text(face="bold", size=14),
        axis.title.x = element_text(size=12),
        axis.title.y = element_text(size=12),
        axis.text.y = element_text(size=12),
        axis.text.x = element_text(size=10))

g

```


\clearpage

# Effects of medium-term loss of commercial length data {#sec:AppendixB}

## Area 3CD

```{r tab-mean-weight-recent-3cd-2, results='asis'}
mw.table(c(base.model.3cd, sens.models.22), 
         c(base.model.3cd.name, sens.models.name.22), 
         years=2010:2020,
         caption="Comparison of mean weight values used in the 2020 Reference case model and sensitivity analyses for medium-term loss of mean weight data, Area 3CD. Sc 4 = no mean weight index for 2014:2020; Sc 5 = 2013 mean weight value for 2018:2020.")

```


```{r tab-param-est-biomass-3cd-2, results='asis'}
make.value.table.compare(c(base.model.3cd, sens.models.22), 
                 c(base.model.3cd.name, sens.models.name.22), 
                 years=2010:2021,
                 type= 1,
                 mpdmed="med",
                 caption = "Comparison of recent median posterior biomass estimates from the 2020 Reference case model and sensitivity analyses for medium-term loss of mean weight data, Area 3CD. Sc 4 = no mean weight index for 2014:2020; Sc 5 = 2013 mean weight value for 2018:2020.")

```

\clearpage

```{r tab-param-est-biomass-3cd-per-2, results='asis'}
make.value.table.compare(c(base.model.3cd, sens.models.22), 
                 c(base.model.3cd.name, sens.models.name.22), 
                 years=2010:2021,
                 type= 1,
                 mpdmed="med",
                 caption = "Comparison of percent difference in median posterior biomass estimates from the 2020 Reference case model and sensitivity analyses for medium-term loss of mean weight data, Area 3CD. Sc 4 = no mean weight index for 2014:2020; Sc 5 = 2013 mean weight value for 2018:2020.",
                 percent=TRUE)

```


```{r tab-param-est-recruit-3cd-2, results='asis'}
make.value.table.compare(c(base.model.3cd, sens.models.22), 
                 c(base.model.3cd.name, sens.models.name.22), 
                 years=2010:2020,
                 type= 2,
                 mpdmed="med",
                 caption = "Comparison of percent difference in median posterior recruitment estimates from the 2020 Reference case model and sensitivity analyses for medium-term loss of mean weight data, Area 3CD. Sc 4 = no mean weight index for 2014:2020; Sc 5 = 2013 mean weight value for 2018:2020.",
                 percent=TRUE)

```

\clearpage


```{r fig-base-mean-weight-3cd-sc-4, fig.cap="Scenario 4 model MPD fit to the mean weight data for Area 3CD (no data for 2014-2020). For clarity, only MPD results are shown."}
plot_grid(mw.plot(sens.models.22[[1]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(sens.models.22[[1]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-base-mean-weight-3cd-sc-5, fig.cap="Scenario 5 model MPD fit to the mean weight data for Area 3CD (2013 mean weight index value used for 2014-2020). For clarity, only MPD results are shown."}
plot_grid(mw.plot(sens.models.22[[2]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(sens.models.22[[2]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-sens-biomass-3cd-m1, fig.cap="Sensitivity of biomass estimates to the two medium-term treatments of the commercial mean weight index, Area 3CD."}
b.plot(c(base.model.3cd, sens.models.22), c(base.model.3cd.name, sens.models.name.22))
```

```{r fig-sens-recr-3cd-m2, fig.cap="Sensitivity of recruitment estimates to the two medium-term treatments of the commercial mean weight index, Area 3CD."}
r.plot(c(base.model.3cd, sens.models.22), c(base.model.3cd.name, sens.models.name.22))
```

\clearpage

## Area 5ABCD

```{r tab-mean-weight-recent-5abcd-2, results='asis'}
mw.table(c(base.model.5abcd, sens.models.2), 
         c(base.model.5abcd.name, sens.models.name.2), 
         years=2010:2020,
         caption="Comparison of mean weight values used in the 2020 Reference case model and sensitivity analyses for medium-term loss of mean weight data, Area 5ABCD. Sc 4 = no mean weight index for 2014:2020; Sc 5 = 2013 mean weight value for 2018:2020.")

```

```{r tab-param-est-biomass-5abcd-2, results='asis'}
make.value.table.compare(c(base.model.5abcd, sens.models.2), 
                 c(base.model.5abcd.name, sens.models.name.2), 
                 years=2010:2021,
                 type= 1,
                 mpdmed="med",
                 caption = "Comparison of recent difference in median posterior biomass estimates from the 2020 Reference case model and sensitivity analyses for medium-term loss of mean weight data, Area 5ABCD. Sc 4 = no mean weight index for 2014:2020; Sc 5 = 2013 mean weight value for 2018:2020.")

```

\clearpage

```{r tab-param-est-biomass-5abcd-per-2, results='asis'}
make.value.table.compare(c(base.model.5abcd, sens.models.2), 
                 c(base.model.5abcd.name, sens.models.name.2), 
                 years=2010:2021,
                 type= 1,
                 mpdmed="med",
                 caption = "Comparison of percent difference in median posterior biomass estimates from the 2020 Reference case model and sensitivity analyses for a longer term loss of mean weight data, Area 5ABCD. Sc 4 = no mean weight index for 2014:2020; Sc 5 = 2013 mean weight value for 2018:2020.",
                 percent=TRUE)

```

```{r tab-param-est-recruit-5abcd-2, results='asis'}
make.value.table.compare(c(base.model.5abcd, sens.models.2), 
                 c(base.model.5abcd.name, sens.models.name.2), 
                 years=2010:2020,
                 type= 2,
                 mpdmed="med",
                 caption = "Comparison of recent median posterior recruitment estimates from the 2020 Reference case model and sensitivity analyses for medium-term loss of mean weight data, Area 5ABCD. Sc 4 = no mean weight index for 2014:2020; Sc 5 = 2013 mean weight value for 2018:2020.",
                 percent=TRUE)

```


\clearpage


```{r fig-base-mean-weight-5abcd-sc-4, fig.cap="Scenario 4 model MPD fit to the mean weight data for Area 5ABCD (no data for 2014-2020). For clarity, only MPD results are shown."}
plot_grid(mw.plot(sens.models.2[[1]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(sens.models.2[[1]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-base-mean-weight-5abcd-sc-5, fig.cap="Scenario 5 model MPD fit to the mean weight data for Area 5ABCD (2013 mean weight index value used for 2014-2020). For clarity, only MPD results are shown."}
plot_grid(mw.plot(sens.models.2[[2]], cv = 0.2, every = 10, last.yr = 2020, french=french),
          mw.compare.plot(sens.models.2[[2]], french=french),
          nrow = 1,
          ncol = 2)
```

```{r fig-sens-biomass-5abcd-m1, fig.cap="Sensitivity of biomass estimates to the two medium-term treatments of the commercial mean weight index, Area 5ABCD."}
b.plot(c(base.model.5abcd, sens.models.2), c(base.model.5abcd.name, sens.models.name.2))
```

```{r fig-sens-recr-5abcd-m2, fig.cap="Sensitivity of recruitment estimates to the two medium-term treatments of the commercial mean weight index, Area 5ABCD."}
r.plot(c(base.model.5abcd, sens.models.2), c(base.model.5abcd.name, sens.models.name.2))
```

